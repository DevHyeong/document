# 5장 서비스 추상화
- 5장에서는 지금까지 만든 DAO에 트랜잭션을 적용해보면서 스프링이 어떻게 성격이 비슷한 여러 종류의 기술을 추상화하고 이를 일관된 방법으로 사용할 수 있도록 지원하는지 살펴볼 것이다.

## 사용자 레벨 관리 기능 추가
- 요구사항
  - 사용자의 레벨은 BASIC, SILVER, GOLD 세가지 중 하나다.
  - 사용자가 처음 가입하면 BASIC 레벨이 되며, 이후 활동에 따라서 한 단계씩 업그레이드될 수 있다.
  - 가입 후 50회 이상 로그인을 하면 BASIC에서 SILVER 레벨이 된다.
  - SILVER 레벨이면서 30번 이상 추천을 받으면 GOLD 레벨이 된다.
  - 사용자 레벨의 변경 작업은 일정한 주기를 가지고 일괄적으로 진행된다. 변경 작업 전에는 조건을 충족하더라도 레벨의 변경이 일어나지 않는다.

### 코드 개선(upgradleLevels 함수)
- 아래와 같은 질문을 할 수 있다.
  - 코드에 중복된 부분은 없는가?
  - 코드가 무엇을 하는 것인지 이해하기 불편하지 않은가?
  - 코드가 자신이 있어야 할 자리에 있는가?
  - 앞으로 변경이 일어난다면 어떤 것이 있을 수 있고 그 변화에 쉽게 대응할 수 있게 작성되어 있는가?
- 개선된 코드
  - 각 오브젝트와 메소드가 각각 자기 몫의 책임을 맡아 일하는 구조로 만들어졌음을 알 수 있다.
  - UserService, User, Level이 내부 정보를 다루는 자신의 책임에 충실한 기능을 갖고 있으면서 필요가 생기면 이런 작업을 수행해달라고 서로 요청하는 구조다.
  - 각자 자기 책임에 충실한 작업만 하고 있으니 코드를 이해하기도 쉽다.
  - 객체지향적인 코드는 다른 오브젝트의 데이터를 가져와서 작업하는 대신 데이터를 갖고 있는 다른 오브젝트에게 작업을 해달라고 요청한다.
  - 오브젝트에게 데이터를 요구하지 말고 작업을 요청하라는 것이 객체지향 프로그래밍의 가장 기본이 되는 원리이기도 하다.
  - 항상 코드를 더 깔끔하고 유연하면서 변화에 대응하기 쉽고 테스트하기 좋게 만들려고 노력해야 함을 기억하자
 
