
## 영속성 전이
- 특정 엔티티를 영속 상태로 만들 때 연관돤 엔티티도 함께 영속 상태로 만들고 싶으면 영속성 전이 기능을 사용하면 된다.
- JPA는 CASCADE 옵션으로 영속성 전이를 제공한다.
- flush를 호출할 때 전이가 발생한다.

### CASCADE 종류(다중 사용 가능)
```
  public enum CascadeType{
    ALL,
    PERSIST,
    MERGE,
    REMOVE,
    REFRESH,
    DETACH
 }
```

### 사용법
```
  @OneToMany(cascade = CascadeType.PERSIST)
  private List<Child> children = new ArrayList<>();
```

## 고아 객체
- JPA는 부모 엔티티와 연관관계가 끊어진 자식 엔티티를 자동으로 삭제하는 기능을 제공하는데 이것을 고아 객체 제거라 한다.
- 부모 엔티티의 컬렉션에서 자식 엔티티의 참조만 제거하면 자식 엔티티가 자동으로 삭제된다.
- 참조가 제거된 엔티티는 다른 곳에서 참조하지 않는 고아 객체로 보고 삭제하는 기능. 참조하는 곳이 하나일 때만 사용해야 한다. 이런 이유로 orphanRemoval은 @OneToOne, @OneToMany에만 사용할 수 있다.

### 사용법
```
  @OneToMany(orphanRemoval = true)
  private List<Child> children = new ArrayList<>();
```
```
  Parent parent = em.find(Parent.class, id);
  parent.getChildren().remove(0); // 자식 엔티티를 컬렉션에서 제거
```
다음의 SQL이 실행된다.
```
  DELETE FROM CHILD WHERE ID = ?
```



