# JPA 정리
참고 : 자바 ORM 표준 JPA 프로그래밍 김영한 지음

## JPA란?


## JPA를 사용해야 하는 이유
- 생산성
  - 반복적인 CRUD용 SQL을 개발자가 직접 작성하지 않아도 된다.

- 유지보수
  - JPA를 사용하지 않으면 엔테티(객체)에 필드를 하나만 추가해도 관련된 CRUD 쿼리를 모두 변경해야 한다.

- 패러다임의 불일치 해결
  - 객체는 참조를 사용해서 다른 객체와 연관관계를 가지고 참조에 접근해서 연관된 객체를 조회한다. 반면 테이블은 외래키를 사용해서 다른 테이블과의 연관관계를 가지고 조인을 사용해서 연관된 테이블을 조회한다. 이렇듯 JPA는 객체와 관계형 데이터베이스의 서로 다른 패러다임을 손쉽게 해결해준다. 

- 성능
  
  
  
## 영속성 관리
### 엔티티 매니저 팩토리(EntityManagerFactory)
- 설정 정보를 읽어서 JPA를 동작시키기 위한 기반 객체를 만들고 JPA 구현체에 따라서는 데이터베이스 커넥션 풀도 생성하므로 엔티티 매니저 팩토리를 생성하는 비용은 아주 크다. 
- 엔티티 매니저 팩토리는 애플리케이션 전체에서 딱 한 번만 생성하고 공유해서 사용해야 한다. 

### 엔티티 매니저(EntityManager)
- 엔티티 매니저 팩토리를 통해 엔티티 매니저가 생성된다.
- 엔티티 매니저를 사용해서 엔티티를 데이터베이스에 CRUD를 할 수 있다.
- 엔티티 매니저는 데이터베이스 연결이 꼭 필요한 시점까지 커넥션을 얻지 않는다. (트랜잭션을 시작할 때 커넥션을 획득한다.)
- 엔티티 매니저는 데이터베이스 커넥션과 밀접한 관계가 있으므로 스레드 간에 공유하거나 재사용하면 안된다.

### 영속성 컨텍스트
- 엔티티를 영구 저장하는 환경
- 엔티티 매니저로 엔티티를 저장하거나 조회하면 엔티티 매니저는 영속성 컨텍스트에 엔티티를 보관하고 관리한다.
- 엔티티 매니저를 통해서 영속성 컨텍스트에 접근할 수 있고, 영속성 컨텍스트를 관리할 수 있다.

### 엔티티의 생명주기
- 비영속
  - 영속성 컨텍스트나 데이터베이스와는 전혀 관련이 없다.
- 영속
  - 엔티티 매니저를 통해 엔티티를 영속성 컨텍스트에 저장.
  -  
- 준영속
- 삭제
